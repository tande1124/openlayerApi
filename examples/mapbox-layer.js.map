{"version":3,"sources":["webpack:///./mapbox-layer.js"],"names":["center","mbMap","mapboxgl","Map","style","attributionControl","boxZoom","container","doubleClickZoom","dragPan","dragRotate","interactive","keyboard","pitchWithRotate","scrollZoom","touchZoomRotate","mbLayer","render","frameState","const","canvas","getCanvas","viewState","visible","getVisible","display","opacity","getOpacity","rotation","jumpTo","zoom","bearing","Math","PI","animate","_frame","cancel","_render","source","attributions","stroke","color","width","vectorLayer","url","format","target","view","layers"],"mappings":"2FAAA,yFAUMA,EAAS,EAAE,KAAM,MAGjBC,EAAQ,IAAIC,SAASC,IAAI,CAC7BC,MAAO,wFACPC,oBAAoB,EACpBC,SAAS,EACTN,OAAQA,EACRO,UAAW,MACXC,iBAAiB,EACjBC,SAAS,EACTC,YAAY,EACZC,aAAa,EACbC,UAAU,EACVC,iBAAiB,EACjBC,YAAY,EACZC,iBAAiB,IAGbC,EAAU,IAAI,IAAM,CACxBC,OAAQ,SAAUC,GAChBC,IAAMC,EAASnB,EAAMoB,YACfC,EAAYJ,EAAWI,UAEvBC,EAAUP,EAAQQ,aACxBJ,EAAOhB,MAAMqB,QAAUF,EAAU,QAAU,OAE3CJ,IAAMO,EAAUV,EAAQW,aACxBP,EAAOhB,MAAMsB,QAAUA,EAGvBP,IAAMS,EAAWN,EAAUM,SAiB3B,OAhBA3B,EAAM4B,OAAO,CACX7B,OAAQ,YAASsB,EAAUtB,QAC3B8B,KAAMR,EAAUQ,KAAO,EACvBC,QAAsB,KAAXH,EAAkBI,KAAKC,GAClCC,SAAS,IAMPjC,EAAMkC,SACRlC,EAAMkC,OAAOC,SACbnC,EAAMkC,OAAS,MAEjBlC,EAAMoC,UAECjB,GAETkB,OAAQ,IAAI,IAAO,CACjBC,aAAc,CACZ,+EACA,0GAKAnC,EAAQ,IAAI,IAAM,CACtBoC,OAAQ,IAAI,IAAO,CACjBC,MAAO,UACPC,MAAO,MAILC,EAAc,IAAI,IAAY,CAClCL,OAAQ,IAAI,IAAa,CACvBM,IAAK,iCACLC,OAAQ,IAAI,MAEdzC,MAAOA,IAGG,IAAI,IAAI,CAClB0C,OAAQ,MACRC,KAAM,IAAI,IAAK,CACb/C,OAAQ,YAAWA,GACnB8B,KAAM,IAERkB,OAAQ,CAAChC,EAAS2B,O","file":"mapbox-layer.js","sourcesContent":["import GeoJSON from '../src/ol/format/GeoJSON.js';\r\nimport Layer from '../src/ol/layer/Layer.js';\r\nimport Map from '../src/ol/Map.js';\r\nimport Source from '../src/ol/source/Source.js';\r\nimport VectorLayer from '../src/ol/layer/Vector.js';\r\nimport VectorSource from '../src/ol/source/Vector.js';\r\nimport View from '../src/ol/View.js';\r\nimport {Stroke, Style} from '../src/ol/style.js';\r\nimport {fromLonLat, toLonLat} from '../src/ol/proj.js';\r\n\r\nconst center = [-98.8, 37.9];\r\nconst key = 'get_your_own_D6rA4zTHduk6KOKTXzGB';\r\n\r\nconst mbMap = new mapboxgl.Map({\r\n  style: 'https://api.maptiler.com/maps/bright/style.json?key=' + key,\r\n  attributionControl: false,\r\n  boxZoom: false,\r\n  center: center,\r\n  container: 'map',\r\n  doubleClickZoom: false,\r\n  dragPan: false,\r\n  dragRotate: false,\r\n  interactive: false,\r\n  keyboard: false,\r\n  pitchWithRotate: false,\r\n  scrollZoom: false,\r\n  touchZoomRotate: false,\r\n});\r\n\r\nconst mbLayer = new Layer({\r\n  render: function (frameState) {\r\n    const canvas = mbMap.getCanvas();\r\n    const viewState = frameState.viewState;\r\n\r\n    const visible = mbLayer.getVisible();\r\n    canvas.style.display = visible ? 'block' : 'none';\r\n\r\n    const opacity = mbLayer.getOpacity();\r\n    canvas.style.opacity = opacity;\r\n\r\n    // adjust view parameters in mapbox\r\n    const rotation = viewState.rotation;\r\n    mbMap.jumpTo({\r\n      center: toLonLat(viewState.center),\r\n      zoom: viewState.zoom - 1,\r\n      bearing: (-rotation * 180) / Math.PI,\r\n      animate: false,\r\n    });\r\n\r\n    // cancel the scheduled update & trigger synchronous redraw\r\n    // see https://github.com/mapbox/mapbox-gl-js/issues/7893#issue-408992184\r\n    // NOTE: THIS MIGHT BREAK IF UPDATING THE MAPBOX VERSION\r\n    if (mbMap._frame) {\r\n      mbMap._frame.cancel();\r\n      mbMap._frame = null;\r\n    }\r\n    mbMap._render();\r\n\r\n    return canvas;\r\n  },\r\n  source: new Source({\r\n    attributions: [\r\n      '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">© MapTiler</a>',\r\n      '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">© OpenStreetMap contributors</a>',\r\n    ],\r\n  }),\r\n});\r\n\r\nconst style = new Style({\r\n  stroke: new Stroke({\r\n    color: '#319FD3',\r\n    width: 2,\r\n  }),\r\n});\r\n\r\nconst vectorLayer = new VectorLayer({\r\n  source: new VectorSource({\r\n    url: 'data/geojson/countries.geojson',\r\n    format: new GeoJSON(),\r\n  }),\r\n  style: style,\r\n});\r\n\r\nconst map = new Map({\r\n  target: 'map',\r\n  view: new View({\r\n    center: fromLonLat(center),\r\n    zoom: 4,\r\n  }),\r\n  layers: [mbLayer, vectorLayer],\r\n});\r\n"],"sourceRoot":""}