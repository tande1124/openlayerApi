{"version":3,"sources":["webpack:///./modify-test.js"],"names":["styles","image","styleFunction","radius","fill","stroke","color","width","feature","getGeometry","getType","source","features","readFeatures","layer","style","overlayStyle","const","zIndex","concat","select","modify","getFeatures","insertVertexCondition","getArray","every","match","interactions","extend","layers","target","view","center","zoom","multiWorld"],"mappings":"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","file":"modify-test.js","sourcesContent":["import GeoJSON from '../src/ol/format/GeoJSON.js';\r\nimport Map from '../src/ol/Map.js';\r\nimport VectorLayer from '../src/ol/layer/Vector.js';\r\nimport VectorSource from '../src/ol/source/Vector.js';\r\nimport View from '../src/ol/View.js';\r\nimport {Circle as CircleStyle, Fill, Stroke, Style} from '../src/ol/style.js';\r\nimport {\r\n  Modify,\r\n  Select,\r\n  defaults as defaultInteractions,\r\n} from '../src/ol/interaction.js';\r\n\r\nconst styleFunction = (function () {\r\n  const styles = {};\r\n  const image = new CircleStyle({\r\n    radius: 5,\r\n    fill: null,\r\n    stroke: new Stroke({color: 'orange', width: 2}),\r\n  });\r\n  styles['Point'] = new Style({image: image});\r\n  styles['Polygon'] = new Style({\r\n    stroke: new Stroke({\r\n      color: 'blue',\r\n      width: 3,\r\n    }),\r\n    fill: new Fill({\r\n      color: 'rgba(0, 0, 255, 0.1)',\r\n    }),\r\n  });\r\n  styles['MultiLineString'] = new Style({\r\n    stroke: new Stroke({\r\n      color: 'green',\r\n      width: 3,\r\n    }),\r\n  });\r\n  styles['MultiPolygon'] = new Style({\r\n    stroke: new Stroke({\r\n      color: 'yellow',\r\n      width: 1,\r\n    }),\r\n    fill: new Fill({\r\n      color: 'rgba(255, 255, 0, 0.1)',\r\n    }),\r\n  });\r\n  styles['default'] = new Style({\r\n    stroke: new Stroke({\r\n      color: 'red',\r\n      width: 3,\r\n    }),\r\n    fill: new Fill({\r\n      color: 'rgba(255, 0, 0, 0.1)',\r\n    }),\r\n    image: image,\r\n  });\r\n  return function (feature) {\r\n    return styles[feature.getGeometry().getType()] || styles['default'];\r\n  };\r\n})();\r\n\r\nconst geojsonObject = {\r\n  'type': 'FeatureCollection',\r\n  'crs': {\r\n    'type': 'name',\r\n    'properties': {\r\n      'name': 'EPSG:3857',\r\n    },\r\n  },\r\n  'features': [\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'Point',\r\n        'coordinates': [0, 0],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'MultiPoint',\r\n        'coordinates': [\r\n          [-2e6, 0],\r\n          [0, -2e6],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'LineString',\r\n        'coordinates': [\r\n          [4e6, -2e6],\r\n          [8e6, 2e6],\r\n          [9e6, 2e6],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'LineString',\r\n        'coordinates': [\r\n          [4e6, -2e6],\r\n          [8e6, 2e6],\r\n          [8e6, 3e6],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'Polygon',\r\n        'coordinates': [\r\n          [\r\n            [-5e6, -1e6],\r\n            [-4e6, 1e6],\r\n            [-3e6, -1e6],\r\n            [-5e6, -1e6],\r\n          ],\r\n          [\r\n            [-4.5e6, -0.5e6],\r\n            [-3.5e6, -0.5e6],\r\n            [-4e6, 0.5e6],\r\n            [-4.5e6, -0.5e6],\r\n          ],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'MultiLineString',\r\n        'coordinates': [\r\n          [\r\n            [-1e6, -7.5e5],\r\n            [-1e6, 7.5e5],\r\n          ],\r\n          [\r\n            [-1e6, -7.5e5],\r\n            [-1e6, 7.5e5],\r\n            [-5e5, 0],\r\n            [-1e6, -7.5e5],\r\n          ],\r\n          [\r\n            [1e6, -7.5e5],\r\n            [15e5, 0],\r\n            [15e5, 0],\r\n            [1e6, 7.5e5],\r\n          ],\r\n          [\r\n            [-7.5e5, -1e6],\r\n            [7.5e5, -1e6],\r\n          ],\r\n          [\r\n            [-7.5e5, 1e6],\r\n            [7.5e5, 1e6],\r\n          ],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'MultiPolygon',\r\n        'coordinates': [\r\n          [\r\n            [\r\n              [-5e6, 6e6],\r\n              [-5e6, 8e6],\r\n              [-3e6, 8e6],\r\n              [-3e6, 6e6],\r\n              [-5e6, 6e6],\r\n            ],\r\n          ],\r\n          [\r\n            [\r\n              [-3e6, 6e6],\r\n              [-2e6, 8e6],\r\n              [0, 8e6],\r\n              [0, 6e6],\r\n              [-3e6, 6e6],\r\n            ],\r\n          ],\r\n          [\r\n            [\r\n              [1e6, 6e6],\r\n              [1e6, 8e6],\r\n              [3e6, 8e6],\r\n              [3e6, 6e6],\r\n              [1e6, 6e6],\r\n            ],\r\n          ],\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      'type': 'Feature',\r\n      'geometry': {\r\n        'type': 'GeometryCollection',\r\n        'geometries': [\r\n          {\r\n            'type': 'LineString',\r\n            'coordinates': [\r\n              [-5e6, -5e6],\r\n              [0, -5e6],\r\n            ],\r\n          },\r\n          {\r\n            'type': 'Point',\r\n            'coordinates': [4e6, -5e6],\r\n          },\r\n          {\r\n            'type': 'Polygon',\r\n            'coordinates': [\r\n              [\r\n                [1e6, -5e6],\r\n                [2e6, -3.5e6],\r\n                [3e6, -5e6],\r\n                [1e6, -5e6],\r\n              ],\r\n            ],\r\n          },\r\n          {\r\n            'type': 'Polygon',\r\n            'coordinates': [\r\n              [\r\n                [1e6, -5e6],\r\n                [2e6, -6.5e6],\r\n                [3e6, -5e6],\r\n                [1e6, -5e6],\r\n              ],\r\n            ],\r\n          },\r\n        ],\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nconst source = new VectorSource({\r\n  features: new GeoJSON().readFeatures(geojsonObject),\r\n});\r\n\r\nconst layer = new VectorLayer({\r\n  source: source,\r\n  style: styleFunction,\r\n});\r\n\r\nconst overlayStyle = (function () {\r\n  const styles = {};\r\n  styles['Polygon'] = [\r\n    new Style({\r\n      fill: new Fill({\r\n        color: [255, 255, 255, 0.5],\r\n      }),\r\n    }),\r\n    new Style({\r\n      stroke: new Stroke({\r\n        color: [255, 255, 255, 1],\r\n        width: 5,\r\n      }),\r\n    }),\r\n    new Style({\r\n      stroke: new Stroke({\r\n        color: [0, 153, 255, 1],\r\n        width: 3,\r\n      }),\r\n    }),\r\n  ];\r\n  styles['MultiPolygon'] = styles['Polygon'];\r\n\r\n  styles['LineString'] = [\r\n    new Style({\r\n      stroke: new Stroke({\r\n        color: [255, 255, 255, 1],\r\n        width: 5,\r\n      }),\r\n    }),\r\n    new Style({\r\n      stroke: new Stroke({\r\n        color: [0, 153, 255, 1],\r\n        width: 3,\r\n      }),\r\n    }),\r\n  ];\r\n  styles['MultiLineString'] = styles['LineString'];\r\n\r\n  styles['Point'] = [\r\n    new Style({\r\n      image: new CircleStyle({\r\n        radius: 7,\r\n        fill: new Fill({\r\n          color: [0, 153, 255, 1],\r\n        }),\r\n        stroke: new Stroke({\r\n          color: [255, 255, 255, 0.75],\r\n          width: 1.5,\r\n        }),\r\n      }),\r\n      zIndex: 100000,\r\n    }),\r\n  ];\r\n  styles['MultiPoint'] = styles['Point'];\r\n\r\n  styles['GeometryCollection'] = styles['Polygon'].concat(styles['Point']);\r\n\r\n  return function (feature) {\r\n    return styles[feature.getGeometry().getType()];\r\n  };\r\n})();\r\n\r\nconst select = new Select({\r\n  style: overlayStyle,\r\n});\r\n\r\nconst modify = new Modify({\r\n  features: select.getFeatures(),\r\n  style: overlayStyle,\r\n  insertVertexCondition: function () {\r\n    // prevent new vertices to be added to the polygons\r\n    return !select\r\n      .getFeatures()\r\n      .getArray()\r\n      .every(function (feature) {\r\n        return feature\r\n          .getGeometry()\r\n          .getType()\r\n          .match(/Polygon/);\r\n      });\r\n  },\r\n});\r\n\r\nconst map = new Map({\r\n  interactions: defaultInteractions().extend([select, modify]),\r\n  layers: [layer],\r\n  target: 'map',\r\n  view: new View({\r\n    center: [0, 1000000],\r\n    zoom: 2,\r\n    multiWorld: true,\r\n  }),\r\n});\r\n"],"sourceRoot":""}