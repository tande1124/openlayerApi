{"version":3,"sources":["webpack:///./wms-time.js"],"names":["threeHoursAgo","Date","Math","round","now","const","extent","startDate","animationId","layers","source","layer","attributions","url","params","target","view","center","zoom","updateInfo","document","getElementById","innerHTML","toISOString","setTime","setMinutes","getMinutes","getSource","updateParams","stop","window","clearInterval","addEventListener","setInterval"],"mappings":"4FAAA,8DAQA,SAASA,IACP,OAAO,IAAIC,KAAwC,KAAnCC,KAAKC,MAAMF,KAAKG,MAAQ,MAAqB,OAG/DC,IAAMC,EAAS,YAAgB,EAAE,IAAK,IAAK,GAAI,IAAK,YAAa,aAC7DC,EAAYP,IAEZQ,EAAc,KAEZC,EAAS,CACb,IAAI,IAAU,CACZC,OAAQ,IAAI,IAAO,CACjBC,MAAO,cAGX,IAAI,IAAU,CACZL,OAAQA,EACRI,OAAQ,IAAI,IAAQ,CAClBE,aAAc,CAAC,yBACfC,IAAK,iEACLC,OAAQ,CAAC,OAAU,wBAIb,IAAI,IAAI,CAClBL,OAAQA,EACRM,OAAQ,MACRC,KAAM,IAAI,IAAK,CACbC,OAAQ,YAAUX,GAClBY,KAAM,MAIV,SAASC,IACIC,SAASC,eAAe,QAChCC,UAAYf,EAAUgB,cAG3B,SAASC,IACPjB,EAAUkB,WAAWlB,EAAUmB,aAAe,IAC1CnB,EAAY,IAAIN,OAClBM,EAAYP,KAEdS,EAAO,GAAGkB,YAAYC,aAAa,CAAC,KAAQrB,EAAUgB,gBACtDJ,IAEFK,IAEAnB,IAAMwB,EAAO,WACS,OAAhBrB,IACFsB,OAAOC,cAAcvB,GACrBA,EAAc,OASEY,SAASC,eAAe,QAChCW,iBAAiB,SANhB,WACXH,IACArB,EAAcsB,OAAOG,YAAYT,EAAS,QAIA,GAEzBJ,SAASC,eAAe,SAChCW,iBAAiB,QAASH,GAAM,GAE3CV,M","file":"wms-time.js","sourcesContent":["import Map from '../src/ol/Map.js';\r\nimport Stamen from '../src/ol/source/Stamen.js';\r\nimport TileLayer from '../src/ol/layer/Tile.js';\r\nimport TileWMS from '../src/ol/source/TileWMS.js';\r\nimport View from '../src/ol/View.js';\r\nimport {getCenter} from '../src/ol/extent.js';\r\nimport {transformExtent} from '../src/ol/proj.js';\r\n\r\nfunction threeHoursAgo() {\r\n  return new Date(Math.round(Date.now() / 3600000) * 3600000 - 3600000 * 3);\r\n}\r\n\r\nconst extent = transformExtent([-126, 24, -66, 50], 'EPSG:4326', 'EPSG:3857');\r\nlet startDate = threeHoursAgo();\r\nconst frameRate = 0.5; // frames per second\r\nlet animationId = null;\r\n\r\nconst layers = [\r\n  new TileLayer({\r\n    source: new Stamen({\r\n      layer: 'terrain',\r\n    }),\r\n  }),\r\n  new TileLayer({\r\n    extent: extent,\r\n    source: new TileWMS({\r\n      attributions: ['Iowa State University'],\r\n      url: 'https://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r-t.cgi',\r\n      params: {'LAYERS': 'nexrad-n0r-wmst'},\r\n    }),\r\n  }),\r\n];\r\nconst map = new Map({\r\n  layers: layers,\r\n  target: 'map',\r\n  view: new View({\r\n    center: getCenter(extent),\r\n    zoom: 4,\r\n  }),\r\n});\r\n\r\nfunction updateInfo() {\r\n  const el = document.getElementById('info');\r\n  el.innerHTML = startDate.toISOString();\r\n}\r\n\r\nfunction setTime() {\r\n  startDate.setMinutes(startDate.getMinutes() + 15);\r\n  if (startDate > new Date()) {\r\n    startDate = threeHoursAgo();\r\n  }\r\n  layers[1].getSource().updateParams({'TIME': startDate.toISOString()});\r\n  updateInfo();\r\n}\r\nsetTime();\r\n\r\nconst stop = function () {\r\n  if (animationId !== null) {\r\n    window.clearInterval(animationId);\r\n    animationId = null;\r\n  }\r\n};\r\n\r\nconst play = function () {\r\n  stop();\r\n  animationId = window.setInterval(setTime, 1000 / frameRate);\r\n};\r\n\r\nconst startButton = document.getElementById('play');\r\nstartButton.addEventListener('click', play, false);\r\n\r\nconst stopButton = document.getElementById('pause');\r\nstopButton.addEventListener('click', stop, false);\r\n\r\nupdateInfo();\r\n"],"sourceRoot":""}