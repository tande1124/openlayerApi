{"version":3,"sources":["webpack:///./vector-tile-selection.js"],"names":["selection","country","stroke","color","width","fill","selectedCountry","vtLayer","declutter","source","maxZoom","format","idProperty","url","style","map","layers","target","view","center","zoom","multiWorld","selectionLayer","renderMode","getSource","feature","getId","selectElement","document","getElementById","on","event","value","type","getFeatures","pixel","then","features","length","changed","const","fid","startsWith"],"mappings":"4FAAA,0EAQIA,EAAY,GAEVC,EAAU,IAAI,IAAM,CACxBC,OAAQ,IAAI,IAAO,CACjBC,MAAO,OACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,yBAGLG,EAAkB,IAAI,IAAM,CAChCJ,OAAQ,IAAI,IAAO,CACjBC,MAAO,sBACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,0BAILI,EAAU,IAAI,IAAgB,CAClCC,WAAW,EACXC,OAAQ,IAAI,IAAiB,CAC3BC,QAAS,GACTC,OAAQ,IAAI,IAAI,CACdC,WAAY,WAEdC,IACE,wHAGJC,MAAOb,IAGHc,EAAM,IAAI,IAAI,CAClBC,OAAQ,CAACT,GACTU,OAAQ,MACRC,KAAM,IAAI,IAAK,CACbC,OAAQ,CAAC,EAAG,GACZC,KAAM,EACNC,YAAY,MAKVC,EAAiB,IAAI,IAAgB,CACzCP,IAAKA,EACLQ,WAAY,SACZd,OAAQF,EAAQiB,YAChBV,MAAO,SAAUW,GACf,GAAIA,EAAQC,UAAW1B,EACrB,OAAOM,KAKPqB,EAAgBC,SAASC,eAAe,QAE9Cd,EAAIe,GAAG,CAAC,QAAS,gBAAgB,SAAUC,GAEd,uBAAxBJ,EAAcK,OACE,gBAAfD,EAAME,MACiB,uBAAxBN,EAAcK,OACE,gBAAfD,EAAME,MAIV1B,EAAQ2B,YAAYH,EAAMI,OAAOC,MAAK,SAAUC,GAC9C,IAAKA,EAASC,OAGZ,OAFAtC,EAAY,QACZsB,EAAeiB,UAGjBC,IAAMf,EAAUY,EAAS,GACzB,GAAKZ,EAAL,CAGAe,IAAMC,EAAMhB,EAAQC,QAEhBC,EAAcK,MAAMU,WAAW,kBACjC1C,EAAY,IAGdA,EAAUyC,GAAOhB,EAEjBH,EAAeiB,mB","file":"vector-tile-selection.js","sourcesContent":["import MVT from '../src/ol/format/MVT.js';\r\nimport Map from '../src/ol/Map.js';\r\nimport VectorTileLayer from '../src/ol/layer/VectorTile.js';\r\nimport VectorTileSource from '../src/ol/source/VectorTile.js';\r\nimport View from '../src/ol/View.js';\r\nimport {Fill, Stroke, Style} from '../src/ol/style.js';\r\n\r\n// lookup for selection objects\r\nlet selection = {};\r\n\r\nconst country = new Style({\r\n  stroke: new Stroke({\r\n    color: 'gray',\r\n    width: 1,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(20,20,20,0.9)',\r\n  }),\r\n});\r\nconst selectedCountry = new Style({\r\n  stroke: new Stroke({\r\n    color: 'rgba(200,20,20,0.8)',\r\n    width: 2,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(200,20,20,0.4)',\r\n  }),\r\n});\r\n\r\nconst vtLayer = new VectorTileLayer({\r\n  declutter: true,\r\n  source: new VectorTileSource({\r\n    maxZoom: 15,\r\n    format: new MVT({\r\n      idProperty: 'iso_a3',\r\n    }),\r\n    url:\r\n      'https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/' +\r\n      'ne:ne_10m_admin_0_countries@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf',\r\n  }),\r\n  style: country,\r\n});\r\n\r\nconst map = new Map({\r\n  layers: [vtLayer],\r\n  target: 'map',\r\n  view: new View({\r\n    center: [0, 0],\r\n    zoom: 2,\r\n    multiWorld: true,\r\n  }),\r\n});\r\n\r\n// Selection\r\nconst selectionLayer = new VectorTileLayer({\r\n  map: map,\r\n  renderMode: 'vector',\r\n  source: vtLayer.getSource(),\r\n  style: function (feature) {\r\n    if (feature.getId() in selection) {\r\n      return selectedCountry;\r\n    }\r\n  },\r\n});\r\n\r\nconst selectElement = document.getElementById('type');\r\n\r\nmap.on(['click', 'pointermove'], function (event) {\r\n  if (\r\n    (selectElement.value === 'singleselect-hover' &&\r\n      event.type !== 'pointermove') ||\r\n    (selectElement.value !== 'singleselect-hover' &&\r\n      event.type === 'pointermove')\r\n  ) {\r\n    return;\r\n  }\r\n  vtLayer.getFeatures(event.pixel).then(function (features) {\r\n    if (!features.length) {\r\n      selection = {};\r\n      selectionLayer.changed();\r\n      return;\r\n    }\r\n    const feature = features[0];\r\n    if (!feature) {\r\n      return;\r\n    }\r\n    const fid = feature.getId();\r\n\r\n    if (selectElement.value.startsWith('singleselect')) {\r\n      selection = {};\r\n    }\r\n    // add selected feature to lookup\r\n    selection[fid] = feature;\r\n\r\n    selectionLayer.changed();\r\n  });\r\n});\r\n"],"sourceRoot":""}