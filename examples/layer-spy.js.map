{"version":3,"sources":["webpack:///./layer-spy.js"],"names":["key","attributions","roads","source","url","tileSize","maxZoom","imagery","container","document","getElementById","map","layers","target","view","center","zoom","radius","addEventListener","evt","which","Math","min","render","preventDefault","max","let","mousePosition","event","getEventPixel","on","const","ctx","context","save","beginPath","pixel","offset","canvasRadius","sqrt","pow","arc","PI","lineWidth","strokeStyle","stroke","clip","restore"],"mappings":"2FAAA,uDAOMA,EAAM,oCACNC,EACJ,4LAGIC,EAAQ,IAAI,IAAU,CAC1BC,OAAQ,IAAI,IAAI,CACdF,aAAcA,EACdG,IAAK,6DAA+DJ,EACpEK,SAAU,IACVC,QAAS,OAIPC,EAAU,IAAI,IAAU,CAC5BJ,OAAQ,IAAI,IAAI,CACdF,aAAcA,EACdG,IAAK,gEAAkEJ,EACvEM,QAAS,OAIPE,EAAYC,SAASC,eAAe,OAEpCC,EAAM,IAAI,IAAI,CAClBC,OAAQ,CAACV,EAAOK,GAChBM,OAAQL,EACRM,KAAM,IAAI,IAAK,CACbC,OAAQ,YAAW,EAAE,IAAK,OAC1BC,KAAM,MAINC,EAAS,GACbR,SAASS,iBAAiB,WAAW,SAAUC,GAC3B,KAAdA,EAAIC,OACNH,EAASI,KAAKC,IAAIL,EAAS,EAAG,KAC9BN,EAAIY,SACJJ,EAAIK,kBACmB,KAAdL,EAAIC,QACbH,EAASI,KAAKI,IAAIR,EAAS,EAAG,IAC9BN,EAAIY,SACJJ,EAAIK,qBAKRE,IAAIC,EAAgB,KAEpBnB,EAAUU,iBAAiB,aAAa,SAAUU,GAChDD,EAAgBhB,EAAIkB,cAAcD,GAClCjB,EAAIY,YAGNf,EAAUU,iBAAiB,YAAY,WACrCS,EAAgB,KAChBhB,EAAIY,YAINhB,EAAQuB,GAAG,aAAa,SAAUF,GAChCG,IAAMC,EAAMJ,EAAMK,QAGlB,GAFAD,EAAIE,OACJF,EAAIG,YACAR,EAAe,CAEjBI,IAAMK,EAAQ,YAAeR,EAAOD,GAC9BU,EAAS,YAAeT,EAAO,CACnCD,EAAc,GAAKV,EACnBU,EAAc,KAEVW,EAAejB,KAAKkB,KACxBlB,KAAKmB,IAAIH,EAAO,GAAKD,EAAM,GAAI,GAAKf,KAAKmB,IAAIH,EAAO,GAAKD,EAAM,GAAI,IAErEJ,EAAIS,IAAIL,EAAM,GAAIA,EAAM,GAAIE,EAAc,EAAG,EAAIjB,KAAKqB,IACtDV,EAAIW,UAAa,EAAIL,EAAgBrB,EACrCe,EAAIY,YAAc,kBAClBZ,EAAIa,SAENb,EAAIc,UAINvC,EAAQuB,GAAG,cAAc,SAAUF,GACrBA,EAAMK,QACdc,e","file":"layer-spy.js","sourcesContent":["import Map from '../src/ol/Map.js';\r\nimport TileLayer from '../src/ol/layer/Tile.js';\r\nimport View from '../src/ol/View.js';\r\nimport XYZ from '../src/ol/source/XYZ.js';\r\nimport {fromLonLat} from '../src/ol/proj.js';\r\nimport {getRenderPixel} from '../src/ol/render.js';\r\n\r\nconst key = 'get_your_own_D6rA4zTHduk6KOKTXzGB';\r\nconst attributions =\r\n  '<a href=\"https://www.maptiler.com/copyright/\" target=\"_blank\">&copy; MapTiler</a> ' +\r\n  '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">&copy; OpenStreetMap contributors</a>';\r\n\r\nconst roads = new TileLayer({\r\n  source: new XYZ({\r\n    attributions: attributions,\r\n    url: 'https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=' + key,\r\n    tileSize: 512,\r\n    maxZoom: 22,\r\n  }),\r\n});\r\n\r\nconst imagery = new TileLayer({\r\n  source: new XYZ({\r\n    attributions: attributions,\r\n    url: 'https://api.maptiler.com/tiles/satellite/{z}/{x}/{y}.jpg?key=' + key,\r\n    maxZoom: 20,\r\n  }),\r\n});\r\n\r\nconst container = document.getElementById('map');\r\n\r\nconst map = new Map({\r\n  layers: [roads, imagery],\r\n  target: container,\r\n  view: new View({\r\n    center: fromLonLat([-109, 46.5]),\r\n    zoom: 6,\r\n  }),\r\n});\r\n\r\nlet radius = 75;\r\ndocument.addEventListener('keydown', function (evt) {\r\n  if (evt.which === 38) {\r\n    radius = Math.min(radius + 5, 150);\r\n    map.render();\r\n    evt.preventDefault();\r\n  } else if (evt.which === 40) {\r\n    radius = Math.max(radius - 5, 25);\r\n    map.render();\r\n    evt.preventDefault();\r\n  }\r\n});\r\n\r\n// get the pixel position with every move\r\nlet mousePosition = null;\r\n\r\ncontainer.addEventListener('mousemove', function (event) {\r\n  mousePosition = map.getEventPixel(event);\r\n  map.render();\r\n});\r\n\r\ncontainer.addEventListener('mouseout', function () {\r\n  mousePosition = null;\r\n  map.render();\r\n});\r\n\r\n// before rendering the layer, do some clipping\r\nimagery.on('prerender', function (event) {\r\n  const ctx = event.context;\r\n  ctx.save();\r\n  ctx.beginPath();\r\n  if (mousePosition) {\r\n    // only show a circle around the mouse\r\n    const pixel = getRenderPixel(event, mousePosition);\r\n    const offset = getRenderPixel(event, [\r\n      mousePosition[0] + radius,\r\n      mousePosition[1],\r\n    ]);\r\n    const canvasRadius = Math.sqrt(\r\n      Math.pow(offset[0] - pixel[0], 2) + Math.pow(offset[1] - pixel[1], 2)\r\n    );\r\n    ctx.arc(pixel[0], pixel[1], canvasRadius, 0, 2 * Math.PI);\r\n    ctx.lineWidth = (5 * canvasRadius) / radius;\r\n    ctx.strokeStyle = 'rgba(0,0,0,0.5)';\r\n    ctx.stroke();\r\n  }\r\n  ctx.clip();\r\n});\r\n\r\n// after rendering the layer, restore the canvas context\r\nimagery.on('postrender', function (event) {\r\n  const ctx = event.context;\r\n  ctx.restore();\r\n});\r\n"],"sourceRoot":""}