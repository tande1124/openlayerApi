{"version":3,"sources":["webpack:///./layer-clipping-vector.js"],"names":["background","className","source","layer","base","clipLayer","style","url","format","getSource","on","setExtent","getExtent","const","fill","color","e","vectorContext","context","globalCompositeOperation","forEachFeature","feature","drawFeature","layers","target","view","center","zoom"],"mappings":"2FAAA,sGAUMA,EAAa,IAAI,IAAU,CAC/BC,UAAW,SACXC,OAAQ,IAAI,IAAO,CACjBC,MAAO,YAILC,EAAO,IAAI,IAAU,CACzBF,OAAQ,IAAI,MAGRG,EAAY,IAAI,IAAY,CAChCC,MAAO,KACPJ,OAAQ,IAAI,IAAa,CACvBK,IAAK,qCACLC,OAAQ,IAAI,QAKhBH,EAAUI,YAAYC,GAAG,cAAc,WACrCN,EAAKO,UAAUN,EAAUI,YAAYG,gBAGvCC,IAAMP,EAAQ,IAAI,IAAM,CACtBQ,KAAM,IAAI,IAAK,CACbC,MAAO,YAIXX,EAAKM,GAAG,cAAc,SAAUM,GAC9BH,IAAMI,EAAgB,YAAiBD,GACvCA,EAAEE,QAAQC,yBAA2B,iBACrCd,EAAUI,YAAYW,gBAAe,SAAUC,GAC7CJ,EAAcK,YAAYD,EAASf,MAErCU,EAAEE,QAAQC,yBAA2B,iBAG3B,IAAI,IAAI,CAClBI,OAAQ,CAACvB,EAAYI,EAAMC,GAC3BmB,OAAQ,MACRC,KAAM,IAAI,IAAK,CACbC,OAAQ,YAAW,CAAC,KAAM,QAC1BC,KAAM,Q","file":"layer-clipping-vector.js","sourcesContent":["import GeoJSON from '../src/ol/format/GeoJSON.js';\r\nimport Map from '../src/ol/Map.js';\r\nimport View from '../src/ol/View.js';\r\nimport {Fill, Style} from '../src/ol/style.js';\r\nimport {OSM, Stamen, Vector as VectorSource} from '../src/ol/source.js';\r\nimport {Tile as TileLayer, Vector as VectorLayer} from '../src/ol/layer.js';\r\nimport {fromLonLat} from '../src/ol/proj.js';\r\nimport {getVectorContext} from '../src/ol/render.js';\r\n\r\n//A distinct className is required to use another canvas for the background\r\nconst background = new TileLayer({\r\n  className: 'stamen',\r\n  source: new Stamen({\r\n    layer: 'toner',\r\n  }),\r\n});\r\n\r\nconst base = new TileLayer({\r\n  source: new OSM(),\r\n});\r\n\r\nconst clipLayer = new VectorLayer({\r\n  style: null,\r\n  source: new VectorSource({\r\n    url: './data/geojson/switzerland.geojson',\r\n    format: new GeoJSON(),\r\n  }),\r\n});\r\n\r\n//Giving the clipped layer an extent is necessary to avoid rendering when the feature is outside the viewport\r\nclipLayer.getSource().on('addfeature', function () {\r\n  base.setExtent(clipLayer.getSource().getExtent());\r\n});\r\n\r\nconst style = new Style({\r\n  fill: new Fill({\r\n    color: 'black',\r\n  }),\r\n});\r\n\r\nbase.on('postrender', function (e) {\r\n  const vectorContext = getVectorContext(e);\r\n  e.context.globalCompositeOperation = 'destination-in';\r\n  clipLayer.getSource().forEachFeature(function (feature) {\r\n    vectorContext.drawFeature(feature, style);\r\n  });\r\n  e.context.globalCompositeOperation = 'source-over';\r\n});\r\n\r\nconst map = new Map({\r\n  layers: [background, base, clipLayer],\r\n  target: 'map',\r\n  view: new View({\r\n    center: fromLonLat([8.23, 46.86]),\r\n    zoom: 7,\r\n  }),\r\n});\r\n"],"sourceRoot":""}